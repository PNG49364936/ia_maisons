<div style="background: #fff8b3; padding: 10px; margin-bottom: 10px;">
  <p><b>DEBUG</b> - @resultat prÃ©sent ? <%= @resultat.present? %></p>
  <p>@resultat : <%= @resultat.inspect %></p>
  <p>params : <%= params.inspect %></p>
</div>

  <div class="container mt-5" id="mycontainer">
    <div>
        <%= link_to "Home", root_path, class: "btn btn-primary" %>
    </div>
    <hr>
    <h1>ðŸ’¡ Estimation du prix d'une maison</h1>

    <%= form_with url: predict_predictions_path, method: :post do |f| %>

      <div>
        <%= f.label :taille, "Taille de la maison (mÂ²) :" %>
        <%= f.number_field :taille, step: 1, required: true %>
      </div>

      <div class="mt-3">
        <label class="form-label">Type de bien :</label>
        <div class="form-check form-check-inline">
          <%= f.radio_button :type_bien, "ancien", checked: true, class: "form-check-input", id: "type_ancien" %>
          <%= f.label :type_ancien, "Ancien", class: "form-check-label" %>
        </div>
        <div class="form-check form-check-inline">
          <%= f.radio_button :type_bien, "neuf", class: "form-check-input", id: "type_neuf" %>
          <%= f.label :type_neuf, "Neuf", class: "form-check-label" %>
        </div>
      </div>

      <div class="mt-3">
        <label class="form-label">Ã‰tat du bien :</label>
        <div class="form-check form-check-inline">
          <%= f.radio_button :etat_bien, "a_renover", checked: true, class: "form-check-input", id: "etat_a_renover" %>
          <%= f.label :etat_a_renover, "A rÃ©nover", class: "form-check-label" %>
        </div>
        <div class="form-check form-check-inline">
          <%= f.radio_button :etat_bien, "bon_etat", class: "form-check-input", id: "etat_bon_etat" %>
          <%= f.label :etat_bon_etat, "Bon Ã©tat", class: "form-check-label" %>
        </div>
        <div class="form-check form-check-inline">
          <%= f.radio_button :etat_bien, "totalement_renove", class: "form-check-input", id: "etat_totalement_renove" %>
          <%= f.label :etat_totalement_renove, "Totalement rÃ©novÃ©", class: "form-check-label" %>
        </div>
      </div>

      <div style="margin-top: 10px;">
        <%= f.submit "PrÃ©dire le prix" %>
      </div>
    <% end %>

    <% if @resultat.present? %>
      <% if @resultat.include?("âš ï¸") %>
        <div style="color: red; margin-top: 10px;"><%= @resultat %></div>
      <% else %>
        <h2 style="color: green; margin-top: 20px;"><%= @resultat %></h2>
      <% end %>
    <% end %>

    <hr>



    <hr>



    <hr>
    <pre><%= @graph_data.inspect %></pre>

    <hr>

    <h3>ðŸ“‰ Graphique : DonnÃ©es dâ€™entraÃ®nement + PrÃ©diction</h3>

    <pre>
    DEBUG - @taille: <%= @taille.inspect %>
    DEBUG - @prix_prevu: <%= @prix_prevu.inspect %>
    </pre>

    <% if @graph_data.present? %>
      <%= line_chart [
            { name: "DonnÃ©es rÃ©elles", data: @graph_data, color: "#4CAF50" },
            # ðŸ”´ Afficher le point de prÃ©diction sâ€™il existe
            (@taille && @prix_prevu) ? { 
              name: "PrÃ©diction", 
              data: { @taille => @prix_prevu },
              color: "#FF0000",
              points: true
            } : nil
          ].compact,
          xtitle: "Taille (mÂ²)",
          ytitle: "Prix (â‚¬)"
      %>
    <% end %>

    <% if @prix_prevu %>
      <p style="margin-top: 15px; font-size: 18px;">
        ðŸ’° <b>Prix prÃ©dit :</b>
        <%= number_with_delimiter(@prix_prevu.round(0).to_i, delimiter: " ") %> â‚¬
        pour une maison de <%= @taille.to_i %> mÂ²
        <% if @type_bien == "neuf" %>
          <span class="badge bg-success">Neuf +10%</span>
        <% else %>
          <span class="badge bg-secondary">Ancien</span>
        <% end %>
      </p>
    <% else %>
      <p style="color: #888;">(Aucune prÃ©diction encore calculÃ©e)</p>
    <% end %>

  </div>












